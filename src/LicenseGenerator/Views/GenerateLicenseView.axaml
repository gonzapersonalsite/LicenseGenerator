<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:LicenseGenerator.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="LicenseGenerator.Views.GenerateLicenseView"
             x:DataType="vm:GenerateLicenseViewModel">
    <Grid RowDefinitions="Auto, *">
        <TextBlock Grid.Row="0" Text="{DynamicResource GenerateViewTitle}" FontSize="{DynamicResource FontSizeExtraLarge}" FontWeight="Bold" Margin="0,0,0,20"/>

        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="20">

                <!-- ═══════════════════════════════════════════ -->
                <!-- Card: License Data                         -->
                <!-- ═══════════════════════════════════════════ -->
                <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
                        BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}" 
                        BorderThickness="1" 
                        CornerRadius="8"
                        Padding="20">
                    <StackPanel Spacing="15">
                        <!-- Section Header -->
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z" 
                                      Width="20" Height="20" Opacity="0.7"/>
                            <TextBlock Text="{DynamicResource GenerateViewTitle}" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        </StackPanel>

                        <Separator Height="1" Background="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,5"/>

                        <!-- Row 1: App + Customer -->
                        <Grid ColumnDefinitions="*, 20, *">
                            <StackPanel Grid.Column="0" Spacing="5">
                                <TextBlock Text="{DynamicResource GenerateAppLabel}" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>
                                <ComboBox ItemsSource="{Binding AvailableApps}" 
                                          SelectedItem="{Binding SelectedApp}" 
                                          HorizontalAlignment="Stretch"
                                          PlaceholderText="{DynamicResource GeneratePlaceholderApp}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2" Spacing="5">
                                <TextBlock Text="{DynamicResource GenerateClientLabel}" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>
                                <TextBox Text="{Binding RegistrationName}" 
                                         Watermark="{DynamicResource GeneratePlaceholderClient}"
                                         FontSize="{DynamicResource FontSizeMedium}"/>
                            </StackPanel>
                        </Grid>

                        <!-- Row 2: HWID + Expiration -->
                        <Grid ColumnDefinitions="*, 20, *">
                            <StackPanel Grid.Column="0" Spacing="5">
                                <TextBlock Text="{DynamicResource GenerateHwidLabel}" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>
                                <TextBox Text="{Binding HardwareId}" 
                                         Watermark="{DynamicResource GeneratePlaceholderHwid}"
                                         FontFamily="Consolas"/>
                                <TextBlock Text="{DynamicResource GenerateHwidHint}" 
                                           FontSize="{DynamicResource FontSizeTiny}" 
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                                           FontStyle="Italic"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2" Spacing="5">
                                <TextBlock Text="{DynamicResource GenerateExpirationLabel}" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>
                                <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Left">
                                    <DatePicker SelectedDate="{Binding ExpirationDate}" 
                                                HorizontalAlignment="Left"
                                                MinWidth="160"/>
                                    <Button Command="{Binding ClearExpirationCommand}" 
                                            Content="{DynamicResource GeneratePermanentBtn}" 
                                            VerticalAlignment="Center"
                                            Padding="12,6"/>
                                </StackPanel>
                                <TextBlock IsVisible="{Binding ExpirationDate, Converter={x:Static ObjectConverters.IsNull}}"
                                           Text="{DynamicResource GeneratePermanentHint}" 
                                           FontSize="{DynamicResource FontSizeTiny}" 
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                                           FontStyle="Italic"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- ═══════════════════════════════════════════ -->
                <!-- Action Button                              -->
                <!-- ═══════════════════════════════════════════ -->
                <Button Command="{Binding GenerateCommand}" 
                        Classes="Primary"
                        HorizontalAlignment="Right"
                        Padding="20,10"
                        FontWeight="Bold"
                        FontSize="{DynamicResource FontSizeMedium}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" 
                                  Width="18" Height="18"/>
                        <TextBlock Text="{DynamicResource GenerateBtnAction}" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <!-- ═══════════════════════════════════════════ -->
                <!-- Card: Generated Result (Conditional)       -->
                <!-- ═══════════════════════════════════════════ -->
                <Border IsVisible="{Binding GeneratedLicense, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                        Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                        BorderBrush="{DynamicResource SystemControlBackgroundAccentBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="20">
                    <StackPanel Spacing="15">
                        <!-- Section Header -->
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" 
                                      Width="20" Height="20" 
                                      Foreground="{DynamicResource SystemControlBackgroundAccentBrush}"/>
                            <TextBlock Text="{DynamicResource GenerateResultLabel}" 
                                       FontSize="{DynamicResource FontSizeLarge}" 
                                       FontWeight="SemiBold" 
                                       Foreground="{DynamicResource SystemControlBackgroundAccentBrush}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <Separator Height="1" Background="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,0"/>

                        <TextBox Text="{Binding GeneratedLicense}" 
                                 IsReadOnly="True" 
                                 TextWrapping="Wrap" 
                                 MaxHeight="120"
                                 FontSize="{DynamicResource FontSizeTiny}"
                                 FontFamily="Consolas"
                                 Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                                 CornerRadius="4"
                                 Padding="10"/>

                        <Button Command="{Binding CopyToClipboardCommand}" 
                                HorizontalAlignment="Right"
                                Classes="Success"
                                Padding="15,8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon Data="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" 
                                          Width="14" Height="14"/>
                                <TextBlock Text="{DynamicResource GenerateCopyBtn}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
